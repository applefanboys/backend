services:
  fastapi-app:
    build: .
    container_name: fastapi-app
    ports:
      - "8000:8000"
    env_file:
      - .env
    depends_on:
      - main-db
    
    # ✅ [추가 1] 내 컴퓨터의 현재 폴더(./)를 컨테이너의 /app 폴더와 연결합니다.
    # 이제 파일을 수정하면 도커에도 즉시 반영됩니다.
    volumes:
      - ./:/app

    # ✅ [추가 2] 개발 모드(--reload)로 실행합니다.
    # 코드가 바뀌면 서버가 알아서 재시작합니다.
    command: uvicorn main:app --host 0.0.0.0 --port 8000 --reload

  main-db:
    image: mysql:8
    environment:
      MYSQL_DATABASE: main_db
      MYSQL_ROOT_PASSWORD: password
    ports:
      - "3307:3306"